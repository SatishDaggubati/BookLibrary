<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Library Management System</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
      <!-- Include Your Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">

     <script>
        setTimeout(function() {
            var successMessage = document.getElementById('successMessage');
            if (successMessage) {
                successMessage.style.display = 'none';
            }
        }, 3000); // Hide after 5 seconds (5000 milliseconds)

        setTimeout(function() {
            var successMess = document.getElementById('successMess');
            if (successMess) {
                successMess.style.display = 'none';
            }
        }, 3000); // Hide after 5 seconds (5000 milliseconds)
    </script>
</head>
<body>

    <div class="container mt-5 p-4 border rounded bg-light">
        <h1 class="mb-4 text-center text-primary">Library Management System</h1>

        <!-- Nav Tabs -->
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <!-- Add Book Tab -->
            <li class="nav-item">
                <a class="nav-link active bg-warning text-white" id="addBook-tab" data-toggle="tab" href="#addBook" role="tab" aria-controls="addBook" aria-selected="true">Add Book</a>
            </li>
            <!-- Search Book Tab -->
            <li class="nav-item">
                <a class="nav-link bg-info text-white" id="searchBook-tab" data-toggle="tab" href="#searchBook" role="tab" aria-controls="searchBook" aria-selected="false">Search Book</a>
            </li>

            <!-- View All Books Tab -->
            <li class="nav-item">
                <a class="nav-link bg-secondary text-white" id="viewAll-tab" data-toggle="tab" href="#viewAll" role="tab" aria-controls="viewAll" aria-selected="false">View All Books</a>
            </li>
                <!-- View All Books Tab -->
            <li class="nav-item">
                <a class="nav-link bg-success text-white" id="retrieveBooks-tab" data-toggle="tab" href="#retrieveBooks" role="tab" aria-controls="viewAll" aria-selected="false">Retrieve Books</a>
            </li>
            <li class="nav-item">
            <a class="nav-link bg-danger text-white" id="borrowBook-tab" data-toggle="tab" href="#borrowBook" role="tab" aria-controls="borrowBook" aria-selected="false">Borrow Book</a>
        </li>
            </li>
            <li class="nav-item">
            <a class="nav-link bg-primary text-white" id="returnBook-tab" data-toggle="tab" href="#returnBook" role="tab" aria-controls="returnBook" aria-selected="false">Return Book</a>
        </li>
            <li class="nav-item ml-auto">
                <a class="nav-link" id="logout-tab" href="/logout">Logout</a>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content mt-4" id="myTabContent">

            <!-- Add Book Tab Content -->
            <div class="tab-pane fade {% if active_tab == 'addBook' %}show active{% endif %}" id="addBook" role="tabpanel" aria-labelledby="addBook-tab">
                <!-- Add Book Form -->
                <form action="/add" method="POST" class="mb-3">
                    <div class="form-group">
                        <label for="title">Title</label>
                        <input type="text" class="form-control" id="title" name="title" required>
                    </div>
                    <div class="form-group">
                        <label for="author">Author</label>
                        <input type="text" class="form-control" id="author" name="author" required>
                    </div>
                    <div class="form-group">
                        <label for="genre">Genre</label>
                        <input type="text" class="form-control" id="genre" name="genre" required>
                    </div>
                    <div class="form-group">
                        <label for="available">Available Copies</label>
                        <input type="number" class="form-control" id="available" name="available" required>
                    </div>
                    <button type="submit" class="btn btn-warning">Add Book</button>
                </form>
                {% if message %}
                    <div id="successMessage" class="alert alert-info mt-3">{{ message }}</div>
                {% endif %}
            </div>

            <!-- Search Book Tab Content -->
             <div class="tab-pane fade {% if active_tab == 'searchBook' %}show active{% endif %}" id="searchBook" role="tabpanel" aria-labelledby="searchBook-tab">
                <!-- Search Book Form -->
                <form action="/search" method="POST" class="mb-3">
                    <div class="form-group">
                        <label for="query">Search Query</label>
                        <input type="text" class="form-control" id="query" name="query" required>
                    </div>
                    <button type="submit" class="btn btn-info">Search</button>
                </form>
                <div id="searchResults" class="mt-3">
                    {% if search_results %}
                        <h3>Search Results</h3>
                        <ul>
                            {% for result in search_results %}
                                <li>{{ result[1] }} by {{ result[2] }} (Genre: {{ result[3] }})  (Available Books: {{ result[4] }})</li>
                            {% endfor %}
                        </ul>

                    {% else %}
                        <p>No results found</p>
                    {% endif %}
                </div>
            </div>

            <!-- View All Books Tab Content -->
          <div class="tab-pane fade {% if active_tab == 'viewAll' %}show active{% endif %}" id="viewAll" role="tabpanel" aria-labelledby="viewAll-tab">
                  <!-- Table displaying all books -->
                <div class="table-responsive">
                    <table class="table table-bordered">
                        <thead class="thead-success">
                            <tr>
                                <th>ID</th>
                                <th>Title</th>
                                <th>Author</th>
                                <th>Genre</th>
                                <th>Available Copies</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                           {% for book in books %}
                            <tr>
                                <td>{{ book[0] }}</td>
                                <td>{{ book[1] }}</td>
                                <td>{{ book[2] }}</td>
                                <td>{{ book[3] }}</td>
                                <td>{{ book[4] }}</td>
                                <td>
                                    <form action="/delete/{{ book[0] }}" method="POST" style="display: inline;">
                                        <button type="submit" class="btn btn-danger">Delete</button>
                                    </form>
                                </td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Retrieve Books Tab Content -->
           <div class="tab-pane fade {% if active_tab == 'retrieveBooks' %}show active{% endif %}" id="retrieveBooks" role="tabpanel" aria-labelledby="retrieveBooks-tab">
                  <!-- Retrieve Books Form -->
               <form action="/retrieve_all" method="POST" style="display: inline-block; margin-bottom:10px;">
                    <button type="submit" class="btn btn-success">Retrieve All</button>
                </form>
                <!-- Table displaying retrieved books -->
                <div class="table-responsive">
                    <table class="table table-bordered">
                        <thead class="thead-warning">
                            <tr>
                                <th>ID</th>
                                <th>Title</th>
                                <th>Author</th>
                                <th>Genre</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                             {% for book in deleted_books %}
                                    <tr>
                                        <td>{{ book[0] }}</td>
                                        <td>{{ book[1] }}</td>
                                        <td>{{ book[2] }}</td>
                                        <td>{{ book[3] }}</td>
                                        <td>
                                            <form action="/retrieve/{{ book[0] }}" method="POST" style="display: inline;">
                                                <button type="submit" class="btn btn-success">Retrieve</button>
                                            </form>
                                        </td>
                                    </tr>
                                {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
                  <!-- Borrow Book Tab -->
            <div class="tab-pane fade {% if active_tab == 'borrowBook' %}show active{% endif %}" id="borrowBook" role="tabpanel" aria-labelledby="borrowBook-tab">
                    <!-- Borrow Book Form -->
                    <form action="/borrow" method="POST" class="mb-3">
                        <div class="form-group">
                            <label for="studentID">Student ID</label>
                            <input type="text" class="form-control" id="studentID" name="studentID" required>
                        </div>
                        <div class="form-group">
                            <label for="studentName">Student Name</label>
                            <input type="text" class="form-control" id="studentName" name="studentName" required>
                        </div>
                        <div class="form-group">
                            <label for="bookID">Book ID</label>
                            <input type="text" class="form-control" id="bookID" name="bookID" required>
                        </div>
                        <button type="submit" class="btn btn-danger">Borrow Book</button>
                    </form>
                    {% if message %}
                        <div id="successMess" class="alert alert-info mt-3">{{ message }}</div>
                    {% endif %}
                </div>

                        <!-- Borrowed Books Tab -->
            <div class="tab-pane fade {% if active_tab == 'returnBook' %}show active{% endif %}" id="returnBook" role="tabpanel" aria-labelledby="returnBook-tab">
                <div class="table-responsive">
                    <table class="table table-bordered">
                        <thead class="thead-success">
                            <tr>
                                <th>BorrowId</th>
                                <th>BookID</th>
                                <th>StudentID</th>
                                <th>StudentName</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                           {% for book in borrowed_books %}
                            <tr>
                                <td>{{ book[0] }}</td>
                                <td>{{ book[1] }}</td>
                                <td>{{ book[2] }}</td>
                                <td>{{ book[3] }}</td>
                                <td>
                                    <form action="/return/{{ book[0] }}" method="POST" style="display: inline;">
                                        <button type="submit" class="btn btn-danger">Return</button>
                                    </form>
                                </td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
    </div>


    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</body>
</html>
